!function(){"use strict";if(_.isUndefined(window.kirkiSetSettingValue)){const e={set(e,t){let i=this,a=wp.customize.settings.controls[e];if(_.isUndefined(a))return!0;switch(i.setValue(e,t),a.type){case"checkbox":case"kirki-toggle":t=!(1!==t&&"1"!==t&&!0!==t),jQuery(i.findElement(e,"input")).prop("checked",t),wp.customize.instance(e).set(t);break;case"kirki-select":i.setSelectWoo(i.findElement(e,"select"),t);break;case"kirki-slider":jQuery(i.findElement(e,"input")).prop("value",t),jQuery(i.findElement(e,".kirki_range_value .value")).html(t);break;case"kirki-generic":(_.isUndefined(a.choices)||_.isUndefined(a.choices.element))&&(a.choices.element="input"),jQuery(i.findElement(e,a.choices.element)).prop("value",t);break;case"kirki-color":i.setColorPicker(i.findElement(e,".kirki-color-control"),t);break;case"kirki-radio-buttonset":case"kirki-radio-image":case"kirki-radio":case"kirki-dashicons":case"kirki-color-palette":case"kirki-palette":jQuery(i.findElement(e,'input[value="'+t+'"]')).prop("checked",!0);break;case"kirki-repeater":case"kirki-custom":break;default:jQuery(i.findElement(e,"input")).prop("value",t)}},setColorPicker(e,t){e.attr("data-default-color",t).data("default-color",t).wpColorPicker("color",t)},setSelectWoo(e,t){jQuery(e).selectWoo().val(t).trigger("change")},setTextarea(e,t){jQuery(e).prop("value",t)},findElement:(e,t)=>wp.customize.control(e).container.find(t),setValue(e,t,i){i=_.isUndefined(i)?100:parseInt(i,10),wp.customize.instance(e).set({}),setTimeout((()=>{wp.customize.instance(e).set(t)}),i)}};window.kirkiSetSettingValue=e}let e={initialized:!1,initialize(){this.initialized||(this.initialized=!0)}};e.initialize(),e=jQuery.extend(e,{control:{"kirki-radio":{init(t){this.template(t),e.input.radio.init(t)},template(t){const i=wp.template("kirki-input-radio");t.container.html(i({label:t.params.label,description:t.params.description,"data-id":t.id,inputAttrs:t.params.inputAttrs,default:t.params.default,value:e.setting.get(t.id),choices:t.params.choices}))}},"kirki-color":{init(t){this.template(t),e.input.color.init(t)},template(t){const i=wp.template("kirki-input-color");t.container.html(i({label:t.params.label,description:t.params.description,"data-id":t.id,mode:t.params.mode,inputAttrs:t.params.inputAttrs,"data-palette":t.params.palette,"data-default-color":t.params.default,"data-alpha":t.params.choices.alpha,value:e.setting.get(t.id)}))}},"kirki-generic":{init:function(t){this.template(t),_.isUndefined(t.params)||_.isUndefined(t.params.choices)||_.isUndefined(t.params.choices.element)||"textarea"!==t.params.choices.element?e.input.genericInput.init(t):e.input.textarea.init(t)},template:function(t){var i,a={label:t.params.label,description:t.params.description,"data-id":t.id,inputAttrs:t.params.inputAttrs,choices:t.params.choices,value:e.setting.get(t.id)};if(!_.isUndefined(t.params)&&!_.isUndefined(t.params.choices)&&!_.isUndefined(t.params.choices.element)&&"textarea"===t.params.choices.element)return i=wp.template("kirki-input-textarea"),void t.container.html(i(a));i=wp.template("kirki-input-generic"),t.container.html(i(a))}},"kirki-number":{init(t){this.template(t),e.input.number.init(t)},template(t){const i=wp.template("kirki-input-number");let a={};t.container.html(i(a={label:t.params.label,description:t.params.description,"data-id":t.id,inputAttrs:t.params.inputAttrs,choices:t.params.choices,value:e.setting.get(t.id)}))}},"kirki-image":{init(t){this.template(t),e.input.image.init(t)},template(t){const i=wp.template("kirki-input-image");let a={};t.container.html(i(a={label:t.params.label,description:t.params.description,"data-id":t.id,inputAttrs:t.params.inputAttrs,choices:t.params.choices,value:e.setting.get(t.id)}))}},"kirki-select":{init(t){this.template(t),e.input.select.init(t)},template(t){const i=wp.template("kirki-input-select");t.container.html(i({label:t.params.label,description:t.params.description,"data-id":t.id,inputAttrs:t.params.inputAttrs,choices:t.params.choices,value:e.setting.get(t.id),multiple:t.params.multiple||1,placeholder:t.params.placeholder}))}}}}),e=jQuery.extend(e,{input:{radio:{init(t){jQuery('input[data-id="'.concat(t.id,'"]')).on("change keyup paste click",(function(){e.setting.set(t.id,jQuery(this).val())}))}},color:{init(t){let i,a=jQuery('.kirki-color-control[data-id="'.concat(t.id,'"]'));t.choices=t.choices||{},_.isEmpty(t.choices)&&t.params.choices&&(t.choices=t.params.choices),_.isEmpty(t.choices)||a.wpColorPicker(t.choices),setTimeout((()=>{i=jQuery('.kirki-input-container[data-id="'.concat(t.id,'"] .wp-picker-clear')),i.length&&i.click((()=>{e.setting.set(t.id,"")}))}),200),a.wpColorPicker({change(){setTimeout((()=>{e.setting.set(t.id,a.val())}),20)}})}},genericInput:{init(t){jQuery('input[data-id="'.concat(t.id,'"]')).on("change keyup paste click",(function(){e.setting.set(t.id,jQuery(this).val())}))}},textarea:{init(t){jQuery('textarea[data-id="'.concat(t.id,'"]')).on("change keyup paste click",(function(){e.setting.set(t.id,jQuery(this).val())}))}},select:{init(t){let i,a=jQuery('select[data-id="'.concat(t.id,'"]')),s=parseInt(a.data("multiple"),10),n={minimumResultsForSearch:-1,escapeMarkup:e=>e};t.params.placeholder&&(n.placeholder=t.params.placeholder,n.allowClear=!0),s>1&&(n.maximumSelectionLength=s),jQuery(a).selectWoo(n).on("change",(function(){i=jQuery(this).val(),i=null===i&&s>1?[]:i,e.setting.set(t.id,i)}))}},number:{init(t){let i,a,s=jQuery('input[data-id="'.concat(t.id,'"]')),n=t.setting._value;t.params.choices=_.defaults(t.params.choices,{min:0,max:100,step:1}),(isNaN(n)||""===n)&&(n=t.params.choices.min<0&&t.params.choices.max>0?0:t.params.choices.min),n=parseFloat(n),t.params.choices.step="any"===t.params.choices.step?.001:t.params.choices.step,t.params.choices.min=parseFloat(t.params.choices.min),t.params.choices.max=parseFloat(t.params.choices.max),t.params.choices.step=parseFloat(t.params.choices.step),i=jQuery('.kirki-input-container[data-id="'.concat(t.id,'"] .plus')),a=jQuery('.kirki-input-container[data-id="'.concat(t.id,'"] .minus')),i.click((()=>{let e,i=parseFloat(s.val());e=i>=t.params.choices.max?i:i+t.params.choices.step,s.val(e),s.trigger("change")})),a.click((()=>{let e,i=parseFloat(s.val());e=i<=t.params.choices.min?i:i-t.params.choices.step,s.val(e),s.trigger("change")})),s.on("change keyup paste click",(function(){let i=jQuery(this).val();isNaN(i)&&(i=parseFloat(i,10),i=isNaN(i)?0:i,jQuery(this).attr("value",i)),e.setting.set(t.id,i)}))}},image:{init(t){let i=e.setting.get(t.id),a=_.isUndefined(t.params.choices)||_.isUndefined(t.params.choices.save_as)?"url":t.params.choices.save_as,s=t.container.find(".placeholder, .thumbnail"),n="array"===a?i.url:i,r=t.container.find(".image-upload-remove-button"),o=t.container.find(".image-default-button");i="array"===a&&_.isString(i)?{url:i}:i,"id"!==a&&"ID"!==a||""===i||wp.media.attachment(i).fetch().then((()=>{setTimeout((()=>{const e=wp.media.attachment(i).get("url");s.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'.concat(e,'" alt="" />'))}),700)})),("url"===a&&""!==i||"array"===a&&!_.isUndefined(i.url)&&""!==i.url)&&t.container.find("image-default-button").hide(),("url"===a&&""===i||"array"===a&&(_.isUndefined(i.url)||""===i.url))&&r.hide(),i===t.params.default&&t.container.find("image-default-button").hide(),""!==n&&s.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'.concat(n,'" alt="" />')),t.container.on("click",".image-upload-button",(i=>{var n=wp.media({multiple:!1}).open().on("select",(()=>{let i=n.state().get("selection").first().toJSON(),l=i.url;_.isUndefined(i.sizes)||(l=i.sizes.full.url,_.isUndefined(i.sizes.medium)?_.isUndefined(i.sizes.thumbnail)||(l=i.sizes.thumbnail.url):l=i.sizes.medium.url),"array"===a?e.setting.set(t.id,{id:i.id,url:i.sizes.full.url,width:i.width,height:i.height}):"id"===a?e.setting.set(t.id,i.id):e.setting.set(t.id,_.isUndefined(i.sizes)?i.url:i.sizes.full.url),s.length&&s.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'.concat(l,'" alt="" />')),r.length&&(r.show(),o.hide())}));i.preventDefault()})),t.container.on("click",".image-upload-remove-button",(i=>{let a,s,n;i.preventDefault(),e.setting.set(t.id,""),a=t.container.find(".placeholder, .thumbnail"),s=t.container.find(".image-upload-remove-button"),n=t.container.find(".image-default-button"),a.length&&a.removeClass().addClass("placeholder").html(kirkiL10n.noFileSelected),s.length&&(s.hide(),jQuery(n).hasClass("button")&&n.show())})),t.container.on("click",".image-default-button",(i=>{let a,s,n;i.preventDefault(),e.setting.set(t.id,t.params.default),a=t.container.find(".placeholder, .thumbnail"),s=t.container.find(".image-upload-remove-button"),n=t.container.find(".image-default-button"),a.length&&a.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'.concat(t.params.default,'" alt="" />')),s.length&&(s.show(),n.hide())}))}}}}),e=jQuery.extend(e,{setting:{get(e){let t=e.split("["),i="",a=0,s="";return _.each(t,((e,t)=>{e=e.replace("]",""),0===t?i=e:i+="[".concat(e,"]"),_.isUndefined(wp.customize.instance(i))||(s=wp.customize.instance(i).get(),a=t),a<t&&_.isObject(s)&&!_.isUndefined(s[e])&&(s=s[e])})),s},set(e,t,i){let a,s,n,r,o,l="",c="",d={};a=e,_.isObject(e)&&(a=jQuery(e).attr("data-id")?e.attr("data-id"):e.parents("[data-id]").attr("data-id")),void 0===wp.customize.control(a)?(s=a.split("["),_.each(s,((e,t)=>{e=e.replace("]",""),l=0===t?e:"[".concat(e,"]"),_.isUndefined(wp.customize.instance(l))||(c=l,n=wp.customize.instance(c).get())})),r=a.replace(c,""),""!==r?(_.isObject(n)||(n={}),"["===r.charAt(0)&&(r=r.replace("[","")),o=r.split("["),_.each(o,((e,t)=>{o[t]=e.replace("]","")})),i&&o.push(i),d='{"'.concat(o.join('":{"'),'":"').concat(t,'"').concat("}".repeat(o.length)),d=JSON.parse(d),jQuery.extend(!0,n,d),t=n):i&&(n=_.isObject(n)?n:{},n[i]=t,t=n),wp.customize.control(c).setting.set(t)):wp.customize.control(a).setting.set(t)}}}),wp.customize.kirkiDynamicControl=wp.customize.Control.extend({initialize(e,t){let i=t||{};i.params=i.params||{},i.params.content||(i.params.content=jQuery("<li></li>"),i.params.content.attr("id","customize-control-".concat(e.replace(/]/g,"").replace(/\[/g,"-"))),i.params.content.attr("class","customize-control customize-control-".concat(i.params.type))),this.propertyElements=[],wp.customize.Control.prototype.initialize.call(this,e,i)},_setUpSettingRootLinks(){let e=this;e.container.find("[data-customize-setting-link]").each((function(){const t=jQuery(this);wp.customize(t.data("customizeSettingLink"),(i=>{const a=new wp.customize.Element(t);e.elements.push(a),a.sync(i),a.set(i())}))}))},_setUpSettingPropertyLinks(){let e,t=this;t.setting&&(e=t.container.find("[data-customize-setting-property-link]"),e.each((function(){let e,i=jQuery(this),a=i.data("customizeSettingPropertyLink");e=new wp.customize.Element(i),t.propertyElements.push(e),e.set(t.setting()[a]),e.bind((e=>{let i=t.setting();e!==i[a]&&(i=_.clone(i),i[a]=e,t.setting.set(i))})),t.setting.bind((t=>{t[a]!==e.get()&&e.set(t[a])}))})))},ready(){const e=this;e._setUpSettingRootLinks(),e._setUpSettingPropertyLinks(),wp.customize.Control.prototype.ready.call(e),e.deferred.embedded.done((()=>{e.initKirkiControl(e)}))},embed(){let e=this,t=e.section();t&&wp.customize.section(t,(t=>{"kirki-expanded"===t.params.type||t.expanded()||wp.customize.settings.autofocus.control===e.id?e.actuallyEmbed():t.expanded.bind((t=>{t&&e.actuallyEmbed()}))}))},actuallyEmbed(){const e=this;"resolved"!==e.deferred.embedded.state()&&(e.renderContent(),e.deferred.embedded.resolve())},focus(e){this.actuallyEmbed(),wp.customize.Control.prototype.focus.call(this,e)},initKirkiControl(t){void 0===e.control[t.params.type]?this.container.on("change keyup paste click","input",(function(){t.setting.set(jQuery(this).val())})):e.control[t.params.type].init(t)}}),_.each(e.control,((e,t)=>{wp.customize.controlConstructor[t]=wp.customize.kirkiDynamicControl.extend({})})),wp.customize.controlConstructor["kirki-dashicons"]=wp.customize.kirkiDynamicControl.extend({}),wp.customize.controlConstructor["kirki-editor"]=wp.customize.kirkiDynamicControl.extend({initKirkiControl(){let e,t=this,i=t.container.find("textarea"),a="kirki-editor-".concat(t.id.replace("[","").replace("]",""));wp.editor.initialize(a,{tinymce:{wpautop:!0},quicktags:!0,mediaButtons:!0}),e=tinyMCE.get(a),e&&e.onChange.add((a=>{let s;a.save(),s=e.getContent(),i.val(s).trigger("change"),wp.customize.instance(t.id).set(s)}))}}),wp.customize.controlConstructor["kirki-multicheck"]=wp.customize.kirkiDynamicControl.extend({initKirkiControl(){const e=this;e.container.on("change","input",(()=>{let t=[],i=0;jQuery.each(e.params.choices,(a=>{e.container.find('input[value="'.concat(a,'"]')).is(":checked")?(e.container.find('input[value="'.concat(a,'"]')).parent().addClass("checked"),t[i]=a,i++):e.container.find('input[value="'.concat(a,'"]')).parent().removeClass("checked")})),e.setting.set(t)}))}}),wp.customize.controlConstructor["kirki-multicolor"]=wp.customize.Control.extend({ready(){!_.isUndefined(window.kirkiControlLoader)&&_.isFunction(kirkiControlLoader)?kirkiControlLoader(this):this.initKirkiControl()},initKirkiControl(){let e=this.params.choices,t=Object.keys(e),i=(this.params.value,0);function a(t,i,a){let s=t.container.find(".multicolor-index-".concat(a)),n={change(){setTimeout((()=>{t.saveValue(a,s.val()),t.container.find(".multicolor-index-".concat(a)).trigger("change")}),100)}};_.isObject(e.irisArgs)&&_.each(e.irisArgs,((e,t)=>{n[t]=e})),s.wpColorPicker(n)}for(;i<Object.keys(e).length;)a(this,0,t[i]),i++},saveValue(e,t){let i=this,a=i.container.find(".multicolor-hidden-value"),s=i.setting._value;s[e]=t,jQuery(a).attr("value",JSON.stringify(s)).trigger("change"),i.setting.set(s)}});const t=function(e,t,i,a){const s=this;this.rowIndex=e,this.container=t,this.label=i,this.header=this.container.find(".repeater-row-header"),this.header.on("click",(()=>{s.toggleMinimize()})),this.container.on("click",".repeater-row-remove",(()=>{s.remove()})),this.header.on("mousedown",(()=>{s.container.trigger("row:start-dragging")})),this.container.on("keyup change","input, select, textarea",(e=>{s.container.trigger("row:update",[s.rowIndex,jQuery(e.target).data("field"),e.target])})),this.setRowIndex=function(e){this.rowIndex=e,this.container.attr("data-row",e),this.container.data("row",e),this.updateLabel()},this.toggleMinimize=function(){this.container.toggleClass("minimized"),this.header.find(".dashicons").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")},this.remove=function(){this.container.slideUp(300,(function(){jQuery(this).detach()})),this.container.trigger("row:remove",[this.rowIndex])},this.updateLabel=function(){let e,t,i;if("field"===this.label.type&&(e=this.container.find('.repeater-field [data-field="'.concat(this.label.field,'"]')),_.isFunction(e.val)&&(t=e.val(),""!==t)))return _.isUndefined(a.params.fields[this.label.field])||_.isUndefined(a.params.fields[this.label.field].type)||("select"===a.params.fields[this.label.field].type?_.isUndefined(a.params.fields[this.label.field].choices)||_.isUndefined(a.params.fields[this.label.field].choices[e.val()])||(t=a.params.fields[this.label.field].choices[e.val()]):"radio"!==a.params.fields[this.label.field].type&&"radio-image"!==a.params.fields[this.label.field].type||(i="".concat(a.selector,' [data-row="').concat(this.rowIndex,'"] .repeater-field [data-field="').concat(this.label.field,'"]:checked'),t=jQuery(i).val())),void this.header.find(".repeater-row-label").text(t);this.header.find(".repeater-row-label").text("".concat(this.label.value," ").concat(this.rowIndex+1))},this.updateLabel()};wp.customize.controlConstructor.repeater=wp.customize.Control.extend({ready(){!_.isUndefined(window.kirkiControlLoader)&&_.isFunction(kirkiControlLoader)?kirkiControlLoader(this):this.initKirkiControl()},initKirkiControl(){let e,t,i=this;const a=this.params.value;this.settingField=this.container.find("[data-customize-setting-link]").first(),this.setValue([],!1),this.repeaterFieldsContainer=this.container.find(".repeater-fields").first(),this.currentIndex=0,this.rows=[],e=!1,_.isUndefined(this.params.choices.limit)||(e=!(this.params.choices.limit<=0)&&parseInt(this.params.choices.limit,10)),this.container.on("click","button.repeater-add",(a=>{a.preventDefault(),!e||i.currentIndex<e?(t=i.addRow(),t.toggleMinimize(),i.initColorPicker(),i.initSelect(t)):jQuery("".concat(i.selector," .limit")).addClass("highlight")})),this.container.on("click",".repeater-row-remove",(()=>{i.currentIndex--,(!e||i.currentIndex<e)&&jQuery("".concat(i.selector," .limit")).removeClass("highlight")})),this.container.on("click keypress",".repeater-field-image .upload-button,.repeater-field-cropped_image .upload-button,.repeater-field-upload .upload-button",(function(e){e.preventDefault(),i.$thisButton=jQuery(this),i.openFrame(e)})),this.container.on("click keypress",".repeater-field-image .remove-button,.repeater-field-cropped_image .remove-button",(function(e){e.preventDefault(),i.$thisButton=jQuery(this),i.removeImage(e)})),this.container.on("click keypress",".repeater-field-upload .remove-button",(function(e){e.preventDefault(),i.$thisButton=jQuery(this),i.removeFile(e)})),this.repeaterTemplate=_.memoize((()=>{let e,t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(a){return e=_.template(i.container.find(".customize-control-repeater-content").first().html(),null,t),e(a)}})),a.length&&_.each(a,(e=>{t=i.addRow(e),i.initColorPicker(),i.initSelect(t,e)})),this.setValue(a,!0,!0),this.repeaterFieldsContainer.sortable({handle:".repeater-row-header",update(){i.sort()}})},openFrame(e){wp.customize.utils.isKeydownButNotEnterEvent(e)||(this.$thisButton.closest(".repeater-field").hasClass("repeater-field-cropped_image")?this.initCropperFrame():this.initFrame(),this.frame.open())},initFrame(){const e=this.getMimeType();this.frame=wp.media({states:[new wp.media.controller.Library({library:wp.media.query({type:e}),multiple:!1,date:!1})]}),this.frame.on("select",this.onSelect,this)},initCropperFrame(){let e=this.$thisButton.siblings("input.hidden-field").attr("data-field"),t=this.getMimeType();_.isString(e)&&""!==e&&_.isObject(this.params.fields[e])&&"cropped_image"===this.params.fields[e].type&&["width","height","flex_width","flex_height"].forEach((t=>{_.isUndefined(this.params.fields[e][t])||(this.params[t]=this.params.fields[e][t])})),this.frame=wp.media({button:{text:"Select and Crop",close:!1},states:[new wp.media.controller.Library({library:wp.media.query({type:t}),multiple:!1,date:!1,suggestedWidth:this.params.width,suggestedHeight:this.params.height}),new wp.media.controller.CustomizeImageCropper({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}),this.frame.on("select",this.onSelectForCrop,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},onSelect(){const e=this.frame.state().get("selection").first().toJSON();this.$thisButton.closest(".repeater-field").hasClass("repeater-field-upload")?this.setFileInRepeaterField(e):this.setImageInRepeaterField(e)},onSelectForCrop(){const e=this.frame.state().get("selection").first().toJSON();this.params.width!==e.width||this.params.height!==e.height||this.params.flex_width||this.params.flex_height?this.frame.setState("cropper"):this.setImageInRepeaterField(e)},onCropped(e){this.setImageInRepeaterField(e)},calculateImageSelectOptions(e,t){let i,a,s,n=t.get("control"),r=!!parseInt(n.params.flex_width,10),o=!!parseInt(n.params.flex_height,10),l=e.get("width"),c=e.get("height"),d=parseInt(n.params.width,10),p=parseInt(n.params.height,10),h=d/p,u=l,m=c;return t.set("canSkipCrop",!n.mustBeCropped(r,o,d,p,l,c)),u/m>h?(p=m,d=p*h):(d=u,p=d/h),i=(u-d)/2,a=(m-p)/2,s={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:l,imageHeight:c,x1:i,y1:a,x2:d+i,y2:p+a},!1===o&&!1===r&&(s.aspectRatio="".concat(d,":").concat(p)),!1===o&&(s.maxHeight=p),!1===r&&(s.maxWidth=d),s},mustBeCropped:(e,t,i,a,s,n)=>!(!0===e&&!0===t||!0===e&&a===n||!0===t&&i===s||i===s&&a===n||s<=i),onSkippedCrop(){const e=this.frame.state().get("selection").first().toJSON();this.setImageInRepeaterField(e)},setImageInRepeaterField(e){const t=this.$thisButton.closest(".repeater-field-image,.repeater-field-cropped_image");t.find(".kirki-image-attachment").html('<img src="'.concat(e.url,'">')).hide().slideDown("slow"),t.find(".hidden-field").val(e.id),this.$thisButton.text(this.$thisButton.data("alt-label")),t.find(".remove-button").show(),t.find("input, textarea, select").trigger("change"),this.frame.close()},setFileInRepeaterField(e){const t=this.$thisButton.closest(".repeater-field-upload");t.find(".kirki-file-attachment").html('<span class="file"><span class="dashicons dashicons-media-default"></span> '.concat(e.filename,"</span>")).hide().slideDown("slow"),t.find(".hidden-field").val(e.id),this.$thisButton.text(this.$thisButton.data("alt-label")),t.find(".upload-button").show(),t.find(".remove-button").show(),t.find("input, textarea, select").trigger("change"),this.frame.close()},getMimeType(){const e=this.$thisButton.siblings("input.hidden-field").attr("data-field");return _.isString(e)&&""!==e&&_.isObject(this.params.fields[e])&&"upload"===this.params.fields[e].type&&!_.isUndefined(this.params.fields[e].mime_type)?this.params.fields[e].mime_type:"image"},removeImage(e){let t,i;wp.customize.utils.isKeydownButNotEnterEvent(e)||(t=this.$thisButton.closest(".repeater-field-image,.repeater-field-cropped_image,.repeater-field-upload"),i=t.find(".upload-button"),t.find(".kirki-image-attachment").slideUp("fast",(function(){jQuery(this).show().html(jQuery(this).data("placeholder"))})),t.find(".hidden-field").val(""),i.text(i.data("label")),this.$thisButton.hide(),t.find("input, textarea, select").trigger("change"))},removeFile(e){let t,i;wp.customize.utils.isKeydownButNotEnterEvent(e)||(t=this.$thisButton.closest(".repeater-field-upload"),i=t.find(".upload-button"),t.find(".kirki-file-attachment").slideUp("fast",(function(){jQuery(this).show().html(jQuery(this).data("placeholder"))})),t.find(".hidden-field").val(""),i.text(i.data("label")),this.$thisButton.hide(),t.find("input, textarea, select").trigger("change"))},getValue(){return JSON.parse(decodeURI(this.setting.get()))},setValue(e,t,i){let a=e,s=[];i&&(jQuery.each(this.params.fields,((e,t)=>{"image"!==t.type&&"cropped_image"!==t.type&&"upload"!==t.type||s.push(e)})),jQuery.each(e,((e,t)=>{jQuery.each(s,((i,s)=>{_.isUndefined(t[s])||_.isUndefined(t[s].id)||(a[e][s]=t[s].id)}))}))),this.setting.set(encodeURI(JSON.stringify(a))),t&&this.settingField.trigger("change")},addRow(e){let i,a,s,n=this,r=n.repeaterTemplate(),o=this.getValue(),l={};if(r){if(i=jQuery.extend(!0,{},n.params.fields),e)for(s in e)e.hasOwnProperty(s)&&i.hasOwnProperty(s)&&(i[s].default=e[s]);for(s in i.index=this.currentIndex,r=r(i),a=new t(n.currentIndex,jQuery(r).appendTo(n.repeaterFieldsContainer),n.params.row_label,n),a.container.on("row:remove",((e,t)=>{n.deleteRow(t)})),a.container.on("row:update",((e,t,i,s)=>{n.updateField.call(n,e,t,i,s),a.updateLabel()})),this.rows[this.currentIndex]=a,i)i.hasOwnProperty(s)&&(l[s]=i[s].default);return o[this.currentIndex]=l,this.setValue(o,!0),this.currentIndex++,a}},sort(){let e=this,t=this.repeaterFieldsContainer.find(".repeater-row"),i=[],a=e.getValue(),s=[],n=[];t.each(((e,t)=>{i.push(jQuery(t).data("row"))})),jQuery.each(i,((t,i)=>{s[t]=e.rows[i],s[t].setRowIndex(t),n[t]=a[i]})),e.rows=s,e.setValue(n)},deleteRow(e){let t,i,a,s=this.getValue();for(a in s[e]&&(t=this.rows[e],t&&(delete s[e],delete this.rows[e],this.setValue(s,!0))),i=1,this.rows)this.rows.hasOwnProperty(a)&&this.rows[a]&&(this.rows[a].updateLabel(),i++)},updateField(e,t,i,a){let s,n,r;this.rows[t]&&this.params.fields[i]&&(s=this.params.fields[i].type,n=this.rows[t],r=this.getValue(),a=jQuery(a),_.isUndefined(r[n.rowIndex][i])||(r[n.rowIndex][i]="checkbox"===s?a.is(":checked"):a.val(),this.setValue(r,!0)))},initColorPicker(){let e=this,t=e.container.find(".color-picker-hex"),i={},a=t.data("field");_.isUndefined(a)||_.isUndefined(e.params.fields[a])||_.isUndefined(e.params.fields[a].palettes)||!_.isObject(e.params.fields[a].palettes)||(i.palettes=e.params.fields[a].palettes),i.change=function(t,i){let a=jQuery(t.target),s=a.closest(".repeater-row").data("row"),n=e.getValue();n[s][a.data("field")]=i.color.toString(),e.setValue(n,!0)},0!==t.length&&t.wpColorPicker(i)},initSelect(e,t){let i,a,s,n=this,r=e.container.find(".repeater-field select"),o={minimumResultsForSearch:-1};0!==r.length&&(a=r.data("field"),s=jQuery(r).data("multiple"),"undefed"!==s&&jQuery.isNumeric(s)&&(s=parseInt(s,10),s>1&&(o.maximumSelectionLength=s)),(t=t||{})[a]=t[a]||"",i=jQuery(r).selectWoo(o).val(t[a]||jQuery(r).val()),this.container.on("change",".repeater-field select",(function(e){let t=jQuery(e.target),i=t.closest(".repeater-row").data("row"),a=n.getValue();a[i][t.data("field")]=jQuery(this).val(),n.setValue(a)})))}}),wp.customize.controlConstructor["kirki-slider"]=wp.customize.kirkiDynamicControl.extend({initKirkiControl(){let e=this,t="postMessage"===e.setting.transport?"mousemove change":"change",i=e.container.find('input[type="range"]'),a=e.container.find('input[type="text"]'),s=e.setting._value;a.attr("value",s),i.on("mousemove change",(()=>{a.attr("value",i.val())})),i.on(t,(()=>{e.setting.set(i.val())})),a.on("input paste change",(()=>{i.attr("value",a.val()),e.setting.set(a.val())})),e.container.find(".slider-reset").on("click",(()=>{a.attr("value",e.params.default),i.attr("value",e.params.default),e.setting.set(a.val())}))}}),wp.customize.controlConstructor["kirki-switch"]=wp.customize.kirkiDynamicControl.extend({initKirkiControl(){let e=this,t=e.setting._value;this.container.on("change","input",(function(){t=!!jQuery(this).is(":checked"),e.setting.set(t)}))}}),wp.customize.controlConstructor["kirki-toggle"]=wp.customize.kirkiDynamicControl.extend({initKirkiControl(){let e=this,t=e.setting._value;this.container.on("change","input",(function(){t=!!jQuery(this).is(":checked"),e.setting.set(t)}))}}),window.kirki=e}();